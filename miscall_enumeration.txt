The approach detailed in weight_ratio_sampling.txt failed.  Too many
loci produced weight ratios that ranged over 10^6 or more, which
suggests severe undersampling.

Unfortunately, this doesn't bode well for generating sample points
from the full Posterior, because it means we don't have a suitable
proposal distribution for it in all cases, and thus cannot sample from
it efficiently.

A new approach is described in this note.  In this new approach, the
posterior is reformulated as a weighted mixture of dirichlets.  Each
dirichlet represents the contribution to the posterior resulting from
{ nA, nC, nG, nT } counts of founder bases.  For D reads, there are
4^D possible underlying ordered sequences of actual founder bases, one
in each read.  Each sequence is weighted according to the probability
that the founder bases take on those values, based on the basecall and
quality.  For example, if the first read has basecall A at quality 30,
then a founder base of 'A' has 0.999, while any other founder base has
0.00033.

These can be grouped by the counts they produce, and the individual
mixture components' weights are summed to produce the mixture
component weight.

Note a few things about this situation:

The counts-grouped components can further be classified according to
the number of miscalls that are hypothesized.  There is exactly 1
zero-miscall component, and it will have the highest probability of
any component.  The probability gets higher if the overall quality of
calls is higher, and it gets lower as depth increases.

There are 12 possible 1-miscall components, but most of them will have
very low probability, because most combinations of mutations have only
a small number of non-majority basecalls.

For example, suppose you have a locus at 500x depth with basecall
counts { 480, 13, 6, 1 }, and assume all calls have quality 30.  Then,
having actual founder base counts of { 479, 14, 6, 1 } means the following:

479 A called as A
13 C called as C
6 G called as G
1 T called as T
1 C called as A

and this can happen 14 ways, each way involving a different C:

0.999^499 * 480 * 0.0003^1 = 0.087

the probability of having founder base counts of { 480, 14, 5, 1 } means:

480 A called as A
13 C called as C
5 G called as G
1 T called as T
1 G called as C

and this can happen in 6 ways, each way involving a different G

The probability of having founder base counts of { 481, 13, 6, 0 } means:

480 A called as A
13 C called as C
6 G called as G
1 A called as T

and this can happen in 481 ways.



0.999^499 * 6 * 0.0003^1 = 0.0011

or 80 times lower.





 We ignore base calls
with quality below some threshold, such as 10 or 15.
